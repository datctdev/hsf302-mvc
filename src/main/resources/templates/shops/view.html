<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${shop != null ? shop.name + ' - Shop' : 'Shop'}">Shop - E-commerce</title>
    <link rel="stylesheet" th:href="@{/css/base.css}">
    <link rel="stylesheet" th:href="@{/css/layout.css}">
    <link rel="stylesheet" th:href="@{/css/components.css}">
    <style>
        .shop-view-container { max-width: 1200px; margin: 2rem auto; padding: 0 1rem; }
        .shop-header-card {
            background: var(--bg-white);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-sm);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        .shop-cover-wrap { margin: -2rem -2rem 1.5rem -2rem; border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0; overflow: hidden; max-height: 200px; }
        .shop-cover-wrap img { width: 100%; height: 200px; object-fit: cover; }
        .shop-header-inner { display: flex; gap: 2rem; align-items: flex-start; flex-wrap: wrap; }
        .shop-logo-wrap { flex-shrink: 0; width: 120px; height: 120px; border-radius: var(--border-radius-lg); overflow: hidden; background: #f0f0f0; display: flex; align-items: center; justify-content: center; font-size: 3rem; }
        .shop-logo-wrap img { width: 100%; height: 100%; object-fit: cover; }
        .shop-meta h1 { margin: 0 0 0.5rem 0; font-size: 1.75rem; }
        .shop-meta .shop-desc { color: var(--text-muted); margin: 0.5rem 0; line-height: 1.5; }
        .shop-products-title { margin: 1.5rem 0 1rem 0; font-size: 1.25rem; }
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 1.5rem; }
        .product-card {
            background: var(--bg-white);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            display: block;
            text-decoration: none;
            color: inherit;
        }
        .product-card:hover { transform: translateY(-4px); box-shadow: var(--shadow-md); }
        .product-card-image { width: 100%; height: 200px; object-fit: cover; background: #f0f0f0; }
        .product-card-body { padding: 1rem; }
        .product-card-title { font-size: 1rem; font-weight: 600; margin-bottom: 0.5rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .product-card-price { font-size: 1.2rem; font-weight: bold; color: var(--primary-color); }
        .pagination { display: flex; gap: 0.5rem; align-items: center; margin-top: 2rem; flex-wrap: wrap; }
        .pagination a, .pagination span { padding: 0.5rem 0.75rem; border: 1px solid var(--border-color); border-radius: var(--border-radius); text-decoration: none; }
        .pagination a:hover { background: var(--bg-light); }
        .empty-products { text-align: center; padding: 3rem; color: var(--text-muted); }
    </style>
</head>
<body>
    <th:block th:replace="~{fragments/header :: header-simple}"></th:block>
    <th:block th:replace="~{fragments/nav-home :: nav-home}"></th:block>

    <main class="main-content">
        <div class="shop-view-container" th:if="${shop != null}">
            <div class="shop-header-card">
                <div th:if="${shop.coverImageUrl != null}" class="shop-cover-wrap">
                    <img th:src="${shop.coverImageUrl}" alt="Cover">
                </div>
                <div class="shop-header-inner">
                    <div class="shop-logo-wrap">
                        <img th:if="${shop.logoUrl != null}" th:src="${shop.logoUrl}" alt="Logo">
                        <span th:unless="${shop.logoUrl != null}">üè™</span>
                    </div>
                    <div class="shop-meta">
                        <h1 th:text="${shop.name}">Shop Name</h1>
                        <p class="shop-desc" th:text="${shop.description ?: 'Ch∆∞a c√≥ m√¥ t·∫£'}">M√¥ t·∫£ shop</p>
                        <p th:if="${shop.phoneNumber != null}" style="margin: 0.25rem 0; color: var(--text-muted);">
                            <strong>Li√™n h·ªá:</strong> <span th:text="${shop.phoneNumber}"></span>
                        </p>
                        <p th:if="${shop.address != null}" style="margin: 0.25rem 0; color: var(--text-muted);">
                            <strong>ƒê·ªãa ch·ªâ:</strong> <span th:text="${shop.address}"></span>
                        </p>
                    </div>
                </div>
            </div>

            <h2 class="shop-products-title">S·∫£n ph·∫©m c·ªßa shop</h2>

            <div th:if="${products == null or products.empty}" class="empty-products">
                Shop ch∆∞a c√≥ s·∫£n ph·∫©m n√†o.
            </div>

            <div th:if="${products != null and !products.empty}" class="products-grid">
                <a th:each="product : ${products}" th:href="@{'/products/' + ${product.id}}" class="product-card">
                    <img th:with="firstImg=${product.images != null and !product.images.empty ? product.images[0] : null}"
                         th:src="${firstImg != null ? firstImg.imageUrl : '/images/placeholder.png'}"
                         alt="S·∫£n ph·∫©m"
                         class="product-card-image"
                         onerror="this.src='/images/placeholder.png'">
                    <div class="product-card-body">
                        <h3 class="product-card-title" th:text="${product.name}">Product Name</h3>
                        <div class="product-card-price" th:text="${#numbers.formatDecimal(product.basePrice, 0, 'POINT', 0, 'POINT') + ' ƒë'}">0 ƒë</div>
                    </div>
                </a>
            </div>

            <div th:if="${productPage != null and productPage.totalPages > 1}" class="pagination">
                <span th:if="${!productPage.first}">
                    <a th:href="@{/shops/{id}(id=${shop.id}, page=${productPage.number - 1}, size=${productPage.size})}">Tr∆∞·ªõc</a>
                </span>
                <span th:text="'Trang ' + (${productPage.number + 1}) + ' / ' + (${productPage.totalPages})">Trang</span>
                <span th:if="${!productPage.last}">
                    <a th:href="@{/shops/{id}(id=${shop.id}, page=${productPage.number + 1}, size=${productPage.size})}">Sau</a>
                </span>
            </div>
        </div>
    </main>

    <th:block th:replace="~{fragments/footer :: footer}"></th:block>
    <script th:src="@{/js/common.js}"></script>
</body>
</html>
