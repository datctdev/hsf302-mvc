<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - E-commerce</title>
    
    <!-- CSS -->
    <link rel="stylesheet" th:href="@{/css/base.css}">
    <link rel="stylesheet" th:href="@{/css/layout.css}">
    <link rel="stylesheet" th:href="@{/css/components.css}">
    <link rel="stylesheet" th:href="@{/css/admin.css}">
</head>
<body>
    <!-- Admin Header -->
    <th:block th:replace="~{fragments/header :: header-admin}"></th:block>
    
    <!-- Admin Navigation -->
    <th:block th:replace="~{fragments/nav-admin :: nav-admin}"></th:block>

    <!-- Main Content -->
    <main class="main-content admin-content">
        <div class="container">
            <!-- Th·ªëng k√™ theo th·ªùi gian -->
            <div class="section" style="margin-bottom: 1.5rem;">
                <h2 style="margin-bottom: 0.75rem;">Th·ªëng k√™ theo th·ªùi gian</h2>
                <form th:action="@{/admin/dashboard}" method="get" style="display: flex; flex-wrap: wrap; gap: 0.75rem; align-items: flex-end;">
                    <div>
                        <label for="fromDate" style="display: block; font-size: 0.85rem; margin-bottom: 0.25rem;">T·ª´ ng√†y</label>
                        <input type="date" id="fromDate" name="fromDate" th:value="${fromDate != null ? #temporals.format(fromDate, 'yyyy-MM-dd') : ''}" style="padding: 0.5rem; border: 1px solid var(--border-color, #ddd); border-radius: 4px;">
                    </div>
                    <div>
                        <label for="toDate" style="display: block; font-size: 0.85rem; margin-bottom: 0.25rem;">ƒê·∫øn ng√†y</label>
                        <input type="date" id="toDate" name="toDate" th:value="${toDate != null ? #temporals.format(toDate, 'yyyy-MM-dd') : ''}" style="padding: 0.5rem; border: 1px solid var(--border-color, #ddd); border-radius: 4px;">
                    </div>
                    <button type="submit" class="btn btn-primary" style="padding: 0.5rem 1rem;">Xem</button>
                </form>
                <div style="margin-top: 0.75rem; display: flex; flex-wrap: wrap; gap: 0.5rem;">
                    <a th:href="${urlLast7}" class="btn" style="padding: 0.4rem 0.75rem; font-size: 0.9rem; background: var(--bg-light, #f5f5f5); border: 1px solid var(--border-color); border-radius: 4px; text-decoration: none;">7 ng√†y qua</a>
                    <a th:href="${urlLast30}" class="btn" style="padding: 0.4rem 0.75rem; font-size: 0.9rem; background: var(--bg-light, #f5f5f5); border: 1px solid var(--border-color); border-radius: 4px; text-decoration: none;">30 ng√†y qua</a>
                    <a th:href="${urlLast90}" class="btn" style="padding: 0.4rem 0.75rem; font-size: 0.9rem; background: var(--bg-light, #f5f5f5); border: 1px solid var(--border-color); border-radius: 4px; text-decoration: none;">90 ng√†y qua</a>
                    <a th:href="${urlAll}" class="btn" style="padding: 0.4rem 0.75rem; font-size: 0.9rem; background: var(--bg-light, #f5f5f5); border: 1px solid var(--border-color); border-radius: 4px; text-decoration: none;">T·∫•t c·∫£</a>
                </div>
                <p th:if="${fromDate != null or toDate != null}" style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-muted, #666);">
                    ƒêang xem: <span th:text="${fromDate != null ? #temporals.format(fromDate, 'dd/MM/yyyy') : '...'}">...</span> ‚Äì <span th:text="${toDate != null ? #temporals.format(toDate, 'dd/MM/yyyy') : '...'}">...</span>
                </p>
                <p th:if="${fromDate == null and toDate == null}" style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-muted, #666);">ƒêang xem: T·∫•t c·∫£ th·ªùi gian</p>
            </div>

            <!-- Statistics Cards -->
            <div class="dashboard-grid">
                <div class="stat-card">
                    <h3>T·ªïng Users</h3>
                    <div class="value" th:text="${totalUsers ?: 0}">0</div>
                    <div class="description">T·ªïng s·ªë ng∆∞·ªùi d√πng</div>
                </div>
                <div class="stat-card success">
                    <h3>Y√™u C·∫ßu Seller</h3>
                    <div class="value" th:text="${pendingRequests ?: 0}">0</div>
                    <div class="description">ƒêang ch·ªù duy·ªát</div>
                </div>
                <div class="stat-card warning">
                    <h3>T·ªïng Shops</h3>
                    <div class="value" th:text="${totalShops ?: 0}">0</div>
                    <div class="description">Shops ƒëang ho·∫°t ƒë·ªông</div>
                </div>
                <div class="stat-card danger">
                    <h3>T·ªïng ƒê∆°n H√†ng</h3>
                    <div class="value" th:text="${totalOrders ?: 0}">0</div>
                    <div class="description">T·∫•t c·∫£ ƒë∆°n h√†ng</div>
                </div>
                <div class="stat-card" style="border-left-color: #0d9488;">
                    <h3>T·ªïng Doanh Thu C√°c Shop</h3>
                    <div class="value" th:text="${totalRevenueShops != null ? (#numbers.formatDecimal(totalRevenueShops, 0, 'POINT', 0, 'POINT') + ' ƒë') : '0 ƒë'}">0 ƒë</div>
                    <div class="description">Doanh thu h√†ng (ti·ªÅn ƒë∆°n ‚àí ph√≠ ship), ƒë∆°n ƒë√£ x√°c nh·∫≠n ‚Üí ƒë√£ giao</div>
                </div>
                <div class="stat-card" style="border-left-color: #6f42c1;">
                    <h3>T·ªïng Hoa H·ªìng N·ªÅn T·∫£ng</h3>
                    <div class="value" th:text="${totalCommission != null ? (#numbers.formatDecimal(totalCommission, 0, 'POINT', 0, 'POINT') + ' ƒë') : '0 ƒë'}">0 ƒë</div>
                    <div class="description">Hoa h·ªìng thu t·ª´ ƒë∆°n ƒë√£ x√°c nh·∫≠n ‚Üí ƒë√£ giao</div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="section">
                <h2>Thao T√°c Nhanh</h2>
                <div class="quick-actions">
                    <a href="/admin/seller-requests" class="action-card">
                        <h3>üìã Duy·ªát Y√™u C·∫ßu Seller</h3>
                        <p>Xem v√† duy·ªát c√°c y√™u c·∫ßu tr·ªü th√†nh seller</p>
                    </a>
                    <a href="/admin/users" class="action-card">
                        <h3>üë• Qu·∫£n L√Ω Users</h3>
                        <p>Xem danh s√°ch v√† qu·∫£n l√Ω ng∆∞·ªùi d√πng</p>
                    </a>
                    <a href="/admin/products" class="action-card">
                        <h3>üì¶ Qu·∫£n L√Ω S·∫£n Ph·∫©m</h3>
                        <p>Xem v√† qu·∫£n l√Ω t·∫•t c·∫£ s·∫£n ph·∫©m</p>
                    </a>
                    <a href="/admin/orders" class="action-card">
                        <h3>üõí Qu·∫£n L√Ω ƒê∆°n H√†ng</h3>
                        <p>Xem v√† x·ª≠ l√Ω ƒë∆°n h√†ng</p>
                    </a>
                    <a href="/admin/commission" class="action-card">
                        <h3>üí∞ C·∫•u h√¨nh hoa h·ªìng</h3>
                        <p>Thay ƒë·ªïi t·ª∑ l·ªá hoa h·ªìng n·ªÅn t·∫£ng theo t·ª´ng s·∫£n ph·∫©m</p>
                    </a>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="section">
                <h2>Ho·∫°t ƒê·ªông G·∫ßn ƒê√¢y</h2>
                <p th:if="${recentActivities == null or recentActivities.empty}" style="color: #666;">Ch∆∞a c√≥ ho·∫°t ƒë·ªông n√†o.</p>
                <ul th:if="${recentActivities != null and !recentActivities.empty}" style="list-style: none; padding: 0; margin: 0.5rem 0 0 0;">
                    <li th:each="act : ${recentActivities}" style="padding: 0.5rem 0; border-bottom: 1px solid var(--border-color, #eee); display: flex; align-items: center; gap: 0.75rem;">
                        <span th:if="${act.type == 'ORDER'}" style="background: var(--primary-color, #007bff); color: white; padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">ƒê∆°n</span>
                        <span th:if="${act.type == 'SELLER_REQUEST'}" style="background: #6f42c1; color: white; padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.75rem;">Y√™u c·∫ßu</span>
                        <a th:href="${act.linkUrl}" th:text="${act.title}" style="flex: 1; text-decoration: none; color: inherit;"></a>
                        <span th:if="${act.at != null}" th:text="${#temporals.format(act.at, 'dd/MM/yyyy HH:mm')}" style="font-size: 0.85rem; color: var(--text-muted, #666);"></span>
                    </li>
                </ul>
            </div>
        </div>
    </main>

    <!-- JavaScript -->
    <script th:src="@{/js/common.js}"></script>
    <script th:src="@{/js/admin.js}"></script>
</body>
</html>
